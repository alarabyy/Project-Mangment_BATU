<!-- src/app/components/navbar/nav/nav.component.html -->

<!-- src/app/components/navbar/nav/nav.component.html -->
<!-- الكود هنا يعتمد على isDarkMode لتغيير شكل الأيقونة، والخدمة تتحكم في الثيم العام -->
<nav class="navbar">
  <div class="navbar-section left">
    <button class="menu-toggle navbar-icon-btn" [class.active]="isMenuOpen" (click)="toggleMenu()">
      <div class="hamburger"><span></span><span></span><span></span></div>
    </button>
  </div>
  <div class="navbar-section center">
    <a routerLink="/Home" class="logo" title="Go to Home">
      <i class="fas fa-sitemap"></i> <span>BATU-Projects</span>
    </a>
  </div>
  <div class="navbar-section right desktop-actions">
    <ng-container *ngIf="authService.isLoggedIn()">
      <a routerLink="/notifications" class="navbar-icon-btn notifications-btn" title="Notifications">
        <i class="fas fa-bell"></i>
        <span class="notification-badge" *ngIf="notificationCount > 0">{{ notificationCount }}</span>
      </a>
      <a routerLink="/my-profile" class="navbar-icon-btn user-avatar-btn" title="My Profile">
        <i class="fas fa-user-graduate"></i>
      </a>
    </ng-container>
    <button class="dark-mode-toggle navbar-icon-btn" (click)="toggleDarkMode()" title="Toggle Dark Mode">
      <span class="icon-container">
        <!-- التحكم في عرض الأيقونة بناءً على حالة isDarkMode -->
        <i *ngIf="!isDarkMode" class="fas fa-moon"></i>
        <i *ngIf="isDarkMode" class="fas fa-sun"></i>
      </span>
    </button>
  </div>
</nav>

<!-- القائمة المنسدلة -->
<div class="dropdown-menu" [class.show]="isMenuOpen">

<nav class="navbar" [class.dark]="isDarkMode">
  <!-- Left Section (Menu Toggle) -->
  <div class="navbar-section left">
    <button class="menu-toggle navbar-icon-btn" [class.active]="isMenuOpen" (click)="toggleMenu()">
      <div class="hamburger"><span></span><span></span><span></span></div>
    </button>
  </div>

  <!-- Center Section (Logo) -->
  <div class="navbar-section center">
    <a routerLink="/Home" class="logo" title="Go to Home">
      <i class="fas fa-sitemap"></i> <span>BATU-Projects</span>
    </a>
  </div>

  <!-- Right Section (Actions) -->
  <div class="navbar-section right desktop-actions">

    <!-- === أزرار تظهر فقط للمستخدم المسجل === -->
    <ng-container *ngIf="authService.isLoggedIn()">

      <!-- 1. زر الإشعارات (الذي طلبته) -->
      <a routerLink="/notifications" class="navbar-icon-btn notifications-btn" title="Notifications">
        <i class="fas fa-bell"></i>
        <span class="notification-badge" *ngIf="notificationCount > 0">{{ notificationCount }}</span>
      </a>

      <!-- 2. زر صفحة البروفايل (الذي طلبته) -->
      <a routerLink="/my-profile" class="navbar-icon-btn user-avatar-btn" title="My Profile">
        <i class="fas fa-user-graduate"></i>
      </a>

    </ng-container>

    <!-- === 3. زر تغيير الثيم (الذي طلبته - يظهر دائمًا) === -->
    <button class="dark-mode-toggle navbar-icon-btn" (click)="toggleDarkMode()" title="Toggle Dark Mode">
      <span class="icon-container">
        <i class="fas fa-sun sun-icon"></i>
        <i class="fas fa-moon moon-icon"></i>
      </span>
    </button>

  </div>
</nav>

<!-- القائمة الجانبية المنسدلة (Dropdown Menu) -->
<div class="dropdown-menu" [class.show]="isMenuOpen" [class.dark]="isDarkMode">
  <div class="menu-header" *ngIf="authService.isLoggedIn()">
    <div class="user-profile-compact">
        <i class="fas fa-user-circle menu-profile-icon"></i>
        <div class="user-details">
            <h4>Welcome, {{ userRole | titlecase }}!</h4>
            <p>Project Contributor</p>
        </div>
    </div>
    <button class="close-menu-btn" (click)="toggleMenu()">×</button>
  </div>

  <ul class="menu-items">
    <!-- الروابط هنا كما هي من قبل، وهي صحيحة -->
    <ng-container *ngIf="authService.isLoggedIn()">
      <!-- روابط مشتركة -->
      <li class="menu-category"><span><i class="fas fa-user-circle"></i> General</span></li>
      <li><a (click)="onMenuItemClick('/projects')" routerLinkActive="active-link"><span class="menu-icon"><i class="fas fa-folder-open"></i></span>Projects</a></li>
      <li><a (click)="onMenuItemClick('/Chat')" routerLinkActive="active-link"><span class="menu-icon"><i class="fas fa-comments"></i></span>Ask AI</a></li>
      <li><a (click)="onMenuItemClick('/my-profile')" routerLinkActive="active-link"><span class="menu-icon"><i class="fas fa-id-card"></i></span>My Profile</a></li>
    </ng-container>

    <!-- ... باقي الروابط كما هي ... -->

    <!-- تسجيل الخروج -->
    <li *ngIf="authService.isLoggedIn()">
      <a (click)="logout()" style="cursor: pointer;"><span class="menu-icon"><i class="fas fa-sign-out-alt"></i></span>Logout</a>
    </li>
  </ul>
</div>
