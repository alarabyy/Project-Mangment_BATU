<!-- src/app/components/report-generator/report-generator.component.html -->
<div class="report-generator-container">
  <header class="page-header">
    <div class="header-content">
      <i class="fas fa-file-invoice header-icon"></i>
      <h1>Report Generator</h1>
    </div>
    <div class="search-container">
      <input
        type="text"
        placeholder="Enter search term (e.g., 'AI', 'Web', project title)..."
        class="search-input"
        [(ngModel)]="searchTerm"
        (keyup.enter)="generateReport()">
      <button class="btn btn-primary" (click)="generateReport()" [disabled]="!searchTerm.trim()">
        <i class="fas fa-search"></i> Generate
      </button>
    </div>
  </header>

  <div class="report-page-wrapper">
    <div *ngIf="isLoading | async" class="status-container">
      <div class="loader"></div>
      <p>Searching for projects...</p>
    </div>
    <div *ngIf="error$ | async as errorMsg" class="status-container error">
      <i class="fas fa-exclamation-triangle"></i>
      <p>{{ errorMsg }}</p>
    </div>

    <ng-container *ngIf="!(isLoading | async) && !(error$ | async)">
      <ng-container *ngIf="projects$ | async as projects">
        <div *ngIf="reportGenerated; else prompt" class="report-content" #reportContent>
          <div class="report-header">
            <h2>Project Search Report</h2>
            <p>Generated on <strong>{{ currentDate | date:'fullDate' }}</strong></p>
            <p>Based on the search term: <strong>"{{ searchTerm }}"</strong></p>
          </div>

          <div *ngIf="projects && projects.length > 0; else noResults">
            <div *ngFor="let project of projects" class="report-project-item">
              <h3>{{ project.title }} <span class="project-id">(ID: {{ project.id }})</span></h3>
              <p class="description">{{ project.description }}</p>
              <div class="details-grid">
                <div><strong>Leader:</strong> {{ project.leader?.name || 'N/A' }}</div>
                <div><strong>Category:</strong> {{ project.category?.name || 'N/A' }}</div>
                <div><strong>Technologies:</strong> {{ project.technologies }}</div>
                <div><strong>Tools:</strong> {{ project.toolsUsed }}</div>
              </div>
            </div>
          </div>
          <ng-template #noResults>
            <div class="no-results">
              <i class="fas fa-folder-open"></i>
              <p>No projects found matching your search term.</p>
            </div>
          </ng-template>

          <div class="report-footer">
            <p>Confidential | Generated by Project Management System</p>
          </div>
        </div>
        <ng-template #prompt>
          <div class="status-container">
            <i class="fas fa-search"></i>
            <p>Enter a search term and click "Generate" to create a report.</p>
          </div>
        </ng-template>
      </ng-container>
    </ng-container>
  </div>

  <div class="download-fab" *ngIf="reportGenerated && (projects$ | async)?.length">
    <button class="btn btn-download" (click)="downloadPDF()" [disabled]="isDownloading">
      <i class="fas" [ngClass]="isDownloading ? 'fa-spinner fa-spin' : 'fa-download'"></i>
      <span>{{ isDownloading ? 'Generating...' : 'Download PDF' }}</span>
    </button>
  </div>

</div>
