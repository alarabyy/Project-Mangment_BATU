<!-- src/app/components/roles/edit-role/edit-role.component.html -->
<div class="container">
  <header class="page-header">
    <div class="header-content"><i class="fas fa-edit header-icon"></i><h1>{{ pageTitle }}</h1></div>
    <a routerLink="/roles" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Back to List</a>
  </header>

  <div *ngIf="isLoading" class="loading-container"><div class="loader"></div> <p>Loading Role...</p></div>

  <form *ngIf="!isLoading" [formGroup]="roleForm" (ngSubmit)="onSubmit()" class="form-card">
    <div class="form-group"><label for="name">Role Name</label><input id="name" formControlName="name" class="form-control" [class.is-invalid]="roleForm.get('name')?.invalid && roleForm.get('name')?.touched"><div *ngIf="roleForm.get('name')?.invalid && roleForm.get('name')?.touched" class="error-message">Role name is required.</div></div>
    <div class="form-group"><label>Permissions</label>
      <div class="permissions-grid">
        <div *ngFor="let group of permissionGroups | keyvalue" class="permission-group">
          <h3>{{ group.key }}</h3>
          <div class="checkbox-grid" formArrayName="permissions">
            <div *ngFor="let permission of group.value" class="checkbox-item">
              <input type="checkbox" [id]="permission" [formControlName]="getPermissionIndex(permission)"><label [for]="permission">{{ permission.split('.')[2] }}</label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="form-actions"><button type="submit" class="btn btn-primary" [disabled]="roleForm.invalid || isSubmitting"><span *ngIf="!isSubmitting"><i class="fas fa-save"></i> Save Changes</span><span *ngIf="isSubmitting"><i class="fas fa-spinner fa-spin"></i> Saving...</span></button></div>
  </form>
</div>
